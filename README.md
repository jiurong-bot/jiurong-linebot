# 九容瑜伽 LINE Bot
簡單說明如下：

infraModule.js (基礎設施模組)：
 * 功能核心： 專注於提供應用程式運行的基礎服務和環境。
 * 具體包含：
   * 伺服器搭建： 使用 Express.js 建立和啟動網頁伺服器（處理 Line Webhook 請求）。
   * 資料庫連接： 管理 PostgreSQL 資料庫的連接和初始化（建立表格等）。
   * Line Bot SDK 整合： 提供 Line Bot 傳送訊息（reply, push）和驗證請求的功能。
   * 環境變數管理： 載入 .env 檔案以使用環境變數。
   * 錯誤日誌： 簡單的錯誤輸出。
   * 自動化任務： 處理定時任務，例如自動清理過期資料庫紀錄、自動發送課程提醒，以及保持伺服器「Keep-alive」以防休眠。
 * 定位： 它是整個應用程式的骨架和底層支持，確保服務能夠穩定運行和與外部系統互動。


index.js (主程式)：
 * 功能核心： 專注於處理應用程式的核心業務邏輯。
 * 具體包含：
   * Line Bot 事件處理： 接收 infraModule 傳來的 Line 訊息和 Postback 事件，並根據事件內容進行判斷和處理。
   * 用戶身份管理： 處理老師和學員的角色切換與驗證。
   * 命令解析： 根據用戶輸入的指令，執行相應的業務操作（例如預約課程、購買點數、管理課程等）。
   * 業務流程控制： 管理多步驟互動的暫存狀態（例如新增課程、購點流程、調整點數等）。
   * 資料庫操作： 定義具體的資料庫讀寫邏輯，但底層的資料庫連接是透過 infraModule 提供的 pgClient 進行。
   * 回覆與推播： 使用 infraModule 提供的 reply 和 push 函數向用戶發送回覆或主動推播訊息。
 * 定位： 它是應用程式的大腦和業務實現，負責理解用戶需求並執行實際的業務操作。
